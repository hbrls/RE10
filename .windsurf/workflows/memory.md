---
description: AI 个人记忆查询（L1-L4 分层检索与引用回答）
---

> updated_by: Cascade - GPT-5
> updated_at: 2026-02-14 16:00:00

# Memory Workflow

用于在用户询问“关于我自己的历史/偏好/模式”时，执行 L1-L4 分层记忆检索，并输出带来源引用、置信度与澄清问题的回答。

## 触发方式

- `/memory`
- `我的记忆里关于 XXX 是什么？`
- `我通常怎么做决策/推进任务？`
- `我最看重什么？`
- `我上周做了什么？`

## 使用定位

- 默认面向个人使用。
- 可作为 AI 执行指令使用，输出偏操作步骤。
- 迁移阶段保持术语体系稳定（L1/L2/L3/L4），不因局部文件缺失破坏流程骨架。

## 执行步骤

1. **读取记忆地图**
   - 读取 `AI_MEMORY/INDEX.md`，识别可用层级与文件入口。

2. **判断问题类型**
   - 在以下类型中判断：事实 / 偏好 / 决策 / 价值观 / 近期事件。

3. **确定检索层级（优先级）**
   - 优先参考 L4（价值观校准）。
   - 按问题下钻：L3（认知）/ L2（行为）/ L1（情境）。

4. **执行关键词检索并读取原文**
   - 每次至少准备两组词：用户原词 + 同义扩展词。
   - 优先获取 2 条证据（不足可继续回答）。
   - 证据记录要素：来源路径、时间信息、原文要点。

5. **冲突检测与校准**
   - 检查跨层级/跨时间冲突。
   - 按“长期模式 vs 近期例外”进行解释。
   - 用 L4 对建议做价值观校准。

6. **生成最终回答**
   - 输出：结论、依据、综合判断、置信度、待确认项。
   - 保持“事实与推断”分离，避免把推断写成事实。

## 问题类型 → 层级映射

1. **价值观类**：L4（必读）+ L1（校验近期偏离）
2. **决策类**：L3 + L4（必读），L2（补充落地）
3. **习惯/偏好类**：L2（必读），L1（近期变化），L4（价值观冲突校验）
4. **近期事件类**：L1（必读），必要时补充 L2/L3 解释原因

## 回答模板（仅 Markdown）

```markdown
结论：{一句话回答用户问题}

依据：
1. {证据1摘要}（来源：{文件路径}）
2. {证据2摘要}（来源：{文件路径}）

综合判断：{跨层级整合后的解释，区分事实与推断}

置信度：{高/中/低}
原因：{证据数量、时间新旧、是否冲突}

如需确认：{1 个最关键澄清问题}
```

## 异常与冲突处理

### 未找到相关记忆

```markdown
我在现有记忆中没有找到与你这个问题直接相关的记录。

可能原因：
1. 这是新情况，尚未沉淀为模式
2. 过去讨论过但未被记录

如果你愿意，我可以按这次结论先给出建议，并在后续帮你补充记忆条目。
```

### 记忆冲突

```markdown
我发现两条记录存在冲突：
- {旧记录}（来源：{路径A}）
- {新记录}（来源：{路径B}）

当前更可能是：{偏好变化/情境差异/记录噪声}。
你希望我以后按哪条作为默认偏好？
```

## 关键原则

- 先证据，后判断。
- 总是引用来源。
- 用 L4 校准建议。
- 诚实处理空白，不编造。
- 区分事实与推断。
- 优先近期信息。
- 迁移阶段保留架构完整性（能力先行、文件后补）。
- 默认静默容错（除非用户追问，不把占位路径作为主输出焦点）。
